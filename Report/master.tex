%\documentclass[11pt]{report}
%\usepackage[a4paper]{geometry}
\input{prelude}

%%%%%%%%%%%%%%%%%%
% BEGIN DOCUMENT %
%%%%%%%%%%%%%%%%%%

%\usepackage[final]{listings}

%\input{csvfiles}

\begin{document}

\maketitle
%\frontmatter
%\makedecl
\input{acknowledgement}
%\include{abstract}
%\mainmatter
%\setcounter{tocdepth}{3}
%\setcounter{secnumdepth}{3} dunno what this does.
{
  \hypersetup{linkcolor=black}
  \tableofcontents
  % Two times compilation
  %\listoffigures
  %\listoftables
   
}
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Intro
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Introduction}
Railway companies need to continuously and sufficiently maintain the train tracks and optimally detect defects in order to have a more punctual and more effective train system. However, the current track-condition assessment system is expensive, time consuming and ineffective, primarily involving manual inspection. 

This condition assessment is evolving from a manual-labor based approach to a data-driven focused industrialized assessment. This paradigm shift from manual to data-driven approach is taking place at this current point in time, as more railway companies are making this transition and funding research within this area as seen in \cite{Sharma2018DatadrivenOO}, \cite{modeltrain}, \cite{Deutsche21:online}, \cite{Howdigit41:online}.

Switzerland's \textit{Swiss Federal Railways} (SBB), is one of those companies being a part of this paradigm shift. SBB has specifically built one special \textit{Diagnostic Vehicle} (Diagnosefahrzeug - DFZ) designed for defect detection and identification among other purposes. For this, accelerometers have been installed at the front and back of the DFZ to collect the signal responses from the wheel and the train track (see appendix \ref{figs:veh}).

A defect in train tracks can be seen as a discontinuity. As a train passes over this discontinuity, it will result in a perturbation that can be detected by sensors. It is our main assumption that each type of defect will have a specific signature that will allow its identification and classification. This is similar to the idea presented in \cite{Introduc31:online}, \cite{pmid28590422} about human activity recognition.

\section{Objective}
The objective of this project is to identify and classify rail surface defects. We aim to build an effective machine learning pipeline that takes information about defects as input and outputs a classification confidence for these defects. By succesfully identifying and classifying the defects, we take one step further toward a predictive maintenance which will result in a more reliable network \cite{unknown}.

\section{Defects}
\label{sec:defects}
A defect can be seen as a deviation from a standard train track; and can be further sub-categorized based on official defect documentation \cite{rail:online} provided by \textit{International Union of Railways} (UIC). Upon inspection of defective tracks, SBB inspectors reports defects with reference to the UIC-based, defect report document by SBB. An example of this can be seen in \ref{app:report}.
%Gleis	149.849086	(400, A-184063)	                  
%chienenzwischenlage	4.989620	(400, A-146358)	
%Bankett	1169.510537	(400, A-103213)
%Schwelle	0.000000	(400, A-118152)	
%Vignolschiene	0.000000	(400, A-231400)	
%Fahrbahn	0.000000	(400, A-233599)	
%First column is track types (object)

Generally, a defect is separated into two overarching types: range- and point-defects. I.e. a defect that is detected at a single point versus a defect that is detected at varying lengths. A point defect is perceived as a sharp signal response, whereas a range-defect is perceived over a greater time period. 
\begin{figure}[H]
	\centering
	%\includegraphics[width = 0.49\textwidth]{imgs/defs/p(400,A-103206)0}
	%\caption{Defect ID: A-$103206$; Report set ID: $400$}
	\includegraphics[width = 0.2\textwidth]{imgs/defs/p(400,A-118152)0}
	\includegraphics[width = 0.38\textwidth]{imgs/defs/p(400,A-231400)0}
	\includegraphics[width = 0.38\textwidth]{imgs/defs/p(400,A-233599)0}
	\caption{Left, middle, right: \\Schwelle: \textit{Beschädigte Betonschwellen} (A-$118152$), \\Fahrbahn: \textit{Verletzungen} (A-$233599$), \\Vignolschiene: \textit{Verletzungen} (A-$231400$). \\The format is: track component: \textit{defect type} (defect ID). These have all been reported as defects (with subcategories) with a length equals to zero, and thus have been classified as point defects using our terminology. (Source of pictures: SBB's defect report document)}
\end{figure}
\raggedbottom
\begin{figure}[H]
	\centering
	%\includegraphics[width = 0.49\textwidth]{imgs/defs/p(400,A-103206)0}
	%\caption{Defect ID: A-$103206$; Report set ID: $400$}
	\includegraphics[width = 0.3\textwidth]{imgs/defs/r(400,A-184063)0}
	\includegraphics[width = 0.3\textwidth]{imgs/defs/r(400,A-184063)1}
	
	\includegraphics[width = 0.3\textwidth]{imgs/defs/r(400,A-146358)0}
	\includegraphics[width = 0.3\textwidth]{imgs/defs/r(400,A-146358)1}
\end{figure}
\begin{figure}[H]
	\centering
	\includegraphics[width = 0.3\textwidth]{imgs/defs/r(400,A-103213)0}
	\caption{Top, middle, bottom:\\ Gleis-$149.8 m$: \textit{Head-Checking: Periodische Rissbildung / Ausbrechungen an der Fahrkante} (A-$184063$),\\ Schienenzwischenlage-$5.0 m$: \textit{Weiterer Abweichungstyp} (A-$146358$),\\ Bankett-$1169.5 m$: \textit{Ungenügendes Schotterprofil} (A-$103213$).\\ The format is: track component-length: \textit{defect type} (defect ID). These have all been reported as defects (with subcategories) with a length strictly greater than zero, and thus have been classified as range defects using our terminology. Most of these range defects have two pictures likely to give more detail. (Source of pictures: SBB's defect report document)}
\end{figure}
\raggedbottom % to get of unnecessary vertical spacing
Furthermore, each defect is associated with a variety of attributes such as: associated component, defect component location, defect type etc. For this work, the focus has been on the defect component/category. That is, the track component with which the defect was identified on (see appendix \ref{app:defcomp}). This is, however, only a rough classification, as this attribute exists at a 'higher level', seeing that the lowest level of defect sub-division is the actual defect type (see appendix \ref{app:deftyp} for a list of defect types).

The defect attribute for analysis is not a trivial choice, as the signal responses likely depend on the defect type its associated component, its location on the component. In the future, it will be important to account for other attributes. Albeit, this work only considers the defect components. In the following, 'defect' will thus refer to these defect components.

Finally, only the point defects are subject to analysis, as this simplifies the problem statement; range-defects and its associated factors are thus disregarded. In the future, range defects naturally also need to be taken into account.

\section{Switches and insulation joints}
To distinguish between defects and non-defects, this work also considers \textit{switches} and \textit{insulation joints}' seen in the figures \ref{fig:swi} and \ref{fig:ins}. The defect signals can vary a lot depending on the component. In addition, these sample amounts are far less compared to that of switches and insulation joints. With the incorporation of these non-defects,  we can thus have access to more samples, where these samples are suspected to have clearer signatures -- easier to classify.

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{imgs/switch0}
	\includegraphics[width = 0.49\textwidth]{imgs/switch1}
	\caption{(Picture sources from right to left: \cite{swi0:online}, \cite{swi1:online})}
	\label{fig:swi}
\end{figure}
\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{imgs/ins_joint0}
	\includegraphics[width = 0.49\textwidth]{imgs/ins_joint1}
	\caption{(Picture sources from right to left: \cite{ins0:online}, \cite{ins1:online})}
	\label{fig:ins}
\end{figure}

In this report, the word 'entity' will be used as an umbrella term for the different track entities: switch, insulation joint and defect.

\section{Data}
The data has been collected and provided by SBB. Using their DFZ, SBB has made trips back and forth to different cities in Switzerland in order to collect various data including but not limited to accelerometer data. After the data collection, the data is imported into a Python-VR object, which is composed of \verb|pandas| \verb|DataFrames|. \verb|Python| objects with pandas \verb|DataFrames| were chosen for their functional flexibility in terms of data storage and data accessibility.

The accelerometers capture the accelerations at the vertical (Z) and transversal (Y) axes (along with the timestamps at each recording), of which, only the Z axis was considered, as it is assumed to be the most responsive to vertical perturbations. These accelerometers are installed on both leading (axle 1) and trailing axles (axle 4) of the measurement coach. See appendix \ref{figs:veh} for visualisations of the accelerometer placements on the DFZ. 

In this work, the following DFZ measurement rides in table \ref{tab:rides} are used for classification.

\begin{table}[H]
	\centering
	\begin{tabular}{|c|c|c|c|} \hline
		\textbf{From} & \textbf{To} & \textbf{Date} & \textbf{Campaign ID}\\ \hline \hline 
		Bern & Olten &  \verb|2019-05-27T08_55_55| & \verb|819Z DFZ01| \\ \hline 
		Olten & Bern &  \verb|2019-05-27T10_03_59| & \verb|077Z DFZ01| \\ \hline 
		Bern & Olten &  \verb|2019-05-27T13_05_53| & \verb|330Z DFZ01| \\ \hline 
		Olten & Bern &  \verb|2019-05-27T14_10_51| & \verb|425Z DFZ01| \\ \hline 
	\end{tabular}
	\caption{Measurement rides for classification. ('From' and 'To' are cities in Switzerland)}
	\label{tab:rides}
\end{table}

Lastly, defect attributes and locations were retrieved from SBB's database and synchronized with the measurement data.

\section{Code}
\label{int:sec:code}
The code is written purely in python. To create neural network architectures, \verb|keras| along with \verb|tensorflow| is used. \verb|keras| is essentially a high-level neural networks library which runs on top of \verb|tensorflow|. It has a consistent, simple API and provides clear and actionable feedback upon user error. Models are easily made by connecting configurable building blocks together, with few restrictions \cite{TensorFl31:online}. The models were trained in \verb|Google Colab|, which is a web application provided by Google that enables users to run python code in the web browser with access to GPUs\footnote{\url{https://colab.research.google.com/notebooks/intro.ipynb}}. It is very similar to \verb|Anaconda's| \verb|Jupyter Notebooks|, except that \verb|Colab| runs in the browser, is collaborative and provides free usage of GPUs (meaning model training goes faster).\\


\noindent All the code can be found on github: \\
\url{https://github.com/Aiyualive/SemesterProject2.0}.\\

\noindent The specific model execution workflow can be found \verb|Colab|:\\
\url{https://colab.research.google.com/drive/12VBz_KrJxeyR_pjpkC87fewv5aMSEI5_}

%keras version number, pandas version number, tensorflow version nmber


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Design and implementation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Design and Implementation}
For the process of defect classification the pipeline in figure \ref{fig:pipeline} was designed. In the next sections, an overview will be given of how each step was implemented.
\begin{figure}[H]
	\centering
	\includegraphics[width = \textwidth]{imgs/pipeline}
	\caption{Primary pipeline}
	\label{fig:pipeline}
\end{figure}


%--> reevaluation| Realised that the results were not very good. So we need to visualise the data and look for separability to make a better model

\section{Localization of the DFZ}

The vehicle is localized using the combination of multiple data streams: track transponders (Eurobalise) GPS signals, Odometers and Switch detection systems. The reported localization error has been determined to be quite small.

The location is reported with respect to the GPS Antenna of the vehicle which is close to the pantograph. It is reported along with a timestamp corresponding to the location of the vehicle at that time at the location of the antenna. 

\section{Shift of GPS timestamps}
Since the exact position (covered distance) at each accelerometer at either side of the GPS antenna is unknown, the goal in this step is to compute these from the reported location of the DFZ. The GPS sensor is sampled at a lower frequency compared to the accelerometers (every $25$ cm vs $24$ kHz respectively). From this, the corresponding GPS positions for each accelerometer sample necessarily need to be found. This is done by linear interpolation using the timestamps of the accelerometers and GPS. 

Depending on the direction of the vehicle, the offset between the accelerometers and the GPS sensor positions on the vehicle body is then added/subtracted to achieve the accelerometer positions.

\section{Peak windows}
Retrieving the signal response around the defect location forms a crucial aspect in the overarching pipeline. The goal of this step is to, around each defect, create a "window" containing accelerometer accelerations of a specified time length -- wherein Within the highest acceleration recording around is found in the center. As a result, all of these windows would be uniform in the sense that they are all centered according to the highest recording of a defect. It is then assumed that each window forms the signature of each track entity. 

Since we are assuming that each track entity is identified by a well-formed peak, we first need to find this peak within a reasonable offset from the defect location, after which we center around that within another reasonable offset. 

In the code, this is done by defining two parameters: \verb|find_peak_offset = 1| and \verb|window_offset = 0.5|. I.e. given a defect timestamp, we search for the maximum, absolute acceleration recording that has occured $1$ second after and $1$ second before the defect timestamp. Once the peak has been found, we then center it in a $1$ second window ($0.5$ sec on each side).


\section{Entity library}
The peak windows arguably forms the central feature of the defect library. However, based on domain knowledge, other features like vehicle speed also needs to be considered for our neural network. Apart from the peak windows, we have likewise extracted other relevant features that might be useful for classifcation:
%timestamps	accelerations	window_length(s)	severity	vehicle_speed(m/s)	axle	campagin_ID	driving_direction	ID	class_labe
%timestamps	accelerations	window_length(s)	severity	vehicle_speed(m/s)	axle	campagin_ID	driving_direction	defect_type	defect_length(m)	line, defect_ID	class_label
\begin{itemize}
	\item \textbf{Timestamps:} timestamps for the sampled acceleration
	\item \textbf{Acceleration:} sampled acceleration at axle box.
	\item \textbf{Vehicle speed (m/s):} vehicle speed at the closest timestamp
	\item \textbf{Severity:} Urgency of the entity; defects have an urgency label signifying how much time is left before acting; labels $1,2,3,4$, where urgency decreases in ascending order. Insulation joints and switches have been self-engineered with label $5$ -- all entities need to have the same feature column for training.
\end{itemize}
Additional information about each entity has been retrieved as well, such as: driving direction, corresponding entity IDs etc. For each entity, we crucially set a true, class label such that we are able to do supervised learning.

Given a specific measurement ride object, we either retrieve each feature directly from the corresponding \verb|dataframe| or with the use of designated helper functions for those requring extra processing. Currently, we have have a 2-level nested \verb|for loop|, looping for each axle outerly, and looping for each entity entry innerly.

The implementation of this could have made more elegant by operating directly on the dataframe, which might also increase speed of the implementation as the \verb|pandas| library has optimised their dataframe operations. The However, speed and efficency was not a major concern in this project. 

The resulting plots for each entity can be seen in figures \ref{fig:insjoint}, \ref{fig:switches}, \ref{fig:defects}; for the defects seen in the the introduction, refer to appendix \ref{app:introdefects}.
%refer to the defects presented in introduction?,  appendix for more signals?
\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_6_AXLE_11_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_6_AXLE_12_077Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_6_AXLE_41_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_6_AXLE_42_077Z_DFZ01}
	\caption{Insulation Joint}
	\label{fig:insjoint}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_46_AXLE_11_425Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_46_AXLE_12_425Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_46_AXLE_41_425Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_46_AXLE_42_425Z_DFZ01}
	\caption{Switches}
	\label{fig:switches}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Vignolschiene_8_AXLE_11_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Vignolschiene_8_AXLE_12_819Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Vignolschiene_8_AXLE_41_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Vignolschiene_8_AXLE_42_819Z_DFZ01}
	\caption{Defect: vignolschiene}
	\label{fig:defects}
\end{figure}



\section{Classification}
We have created a primary \verb|NN| class (short for neural network) along with a \verb|ModelMaker| class. The former does everything from pre-processing the data to evaluating the used model. The latter, as the name suggests, is utlised for creating and using different models, which is useful as we can keep track of how the models have been modified and improved. 

\subsection{NN class}
To make a classification, we first need to select the relevant features. Then we simply feed the features into an \verb|NN| object, where the API of the \verb|NN| class can be called for classification. The usage of the \verb|NN| class is demonstrated below in \ref{tab:nnclass}.


\begin{table}[H]
	\centering
	\small
	\begin{tabular}{l p{0.5\linewidth}}\noalign{\global\arrayrulewidth=0.3mm} 
	\hline 
	\multicolumn{2}{c}{\textbf{API of NN class}}
		\\ \hline  
		\noalign{\global\arrayrulewidth=0.05mm}
		\verb|__init__()|                  & initialises a \verb|NN| object\\ \hline
		\verb|prepare_data()|            & pre-process data, this includes standardisation of data\\ \hline
		\verb|make_model()|              & uses \verb|ModelMaker| class to select a model \\ \hline
		
		\verb|fit()|			         & trains the model\\ \hline
		\verb|classify()|			     & uses the trained model to classify on a test set\\ 
		\noalign{\global\arrayrulewidth=0.3mm} \hline 

		\vspace*{0.25cm}\\
		\hline
		\multicolumn{2}{c}{ \textbf{Other utility API functions} }	
		\\ \hline 
		\noalign{\global\arrayrulewidth=0.05mm}
		\verb|measure_performance()| & currently only on validation data \\ \hline
		\verb|plot_metrics()|          \\  \hline
		\verb|plot_confusion_matrix()| \\ \hline
		\verb|load_weights()|             \\ \hline
		\verb|load_model_()|             \\ \hline
		\verb|save_history()|           \\ \hline
		\verb|save_model()|              \\ \hline
		\verb|save_classification_to_csv()|  \\ \hline
		\noalign{\global\arrayrulewidth=0.3mm}
		\hline \hline
		\verb|run_experiment()| & evaluates the given model for a \# of repetitions\\ 
		\noalign{\global\arrayrulewidth=0.3mm}
		\hline
	\end{tabular}
	\caption{To train a model, the first API functions needs to be called sequentially. Other utility functions are rather self-explanatory.}\label{tab:nnclass}
\end{table}
\raggedbottom % To get rid of weird spacing

\subsection{ModelMaker class}
As mentioned in the introduction \ref{int:sec:code}, this is where we make use of \verb|keras|.

epochs, batch size

conv 1 d,

kernel size

filter

flatten

dropout

sequential model

maxpooling

dense

loss

learning rate

activation functions

input shape

See example of this in next chapter. 

callbacks - when training

metrics can be used for logging
\section{Visualisation}
Finally, after evaluating the results (results can be seen in the next section) from the neural network, we have not achieved any significant results. Arguably, the visualisations of class separability should have been handled first. However, the previous steps took the majority of the time.


using PCA

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Evaluation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Evaluation}
Here we will present the results and discuss the findings herein.


\section{Models}
\begin{table}[H]
	\centering
	\begin{tabular}{|c|c|c| c|} \hline
		\textbf{Layer} & \textbf{Output Shape } & \textbf{Number of params} \\ \hline \hline 
		- & - &  -  \\ \hline 
	\end{tabular}
	\caption{Model 1}
	\label{datasets}
\end{table}

Draw models \url{http://alexlenail.me/NN-SVG/AlexNet.html} \todo{do one model at a time}

\section{Model evaluations}

\begin{table}[H]
	\centering
	\begin{tabular}{|c|c|c|} \hline
		\textbf{Defect} & $2$ & $ \%$\\ \hline
	\end{tabular}
	\caption{Entity distribution, class distributions}
\end{table}

In this section we evaluate our model with regard to a variety of metrics: loss (\textbf{L}), accuracy (\textbf{ACC}), true positives (\textbf{TP}), false positives (\textbf{FP}), true negatives (\textbf{TN}), false negatives (\textbf{FN}), precision (\textbf{P}), recall (\textbf{R}), area under the curve (\textbf{AUC}).
%&{L}&{ACC}&{TP}&{TN}&{FP}&{FN}&{P}&{R}&{AUC}
\begin{table}[H]
		\centering 
		\begin{tabular}{|l||*{5}{c|}}\hline
			\backslashbox{Metric}{Model}
			&\makebox[6.3em]{Model 1}&\makebox[6.3em]{}&\makebox[6.3em]{}&\makebox[6.3em]{} 
			\\\hline\hline
			L   & $-$ & $-$ & $-$ & $-$ \\ \hline
			ACC & $-$ & $-$ & $-$ & $-$ \\ \hline
			TP  & $-$ & $-$ & $-$ & $-$ \\ \hline
			FP  & $-$ & $-$ & $-$ & $-$ \\ \hline
			TN  & $-$ & $-$ & $-$ & $-$ \\ \hline
			FN  & $-$ & $-$ & $-$ & $-$ \\ \hline
			P   & $-$ & $-$ & $-$ & $-$ \\ \hline
			R   & $-$ & $-$ & $-$ & $-$ \\ \hline
			AUC & $-$ & $-$ & $-$ & $-$ \\ \hline
		\end{tabular}
		\captionof{table}{Average metrics times and their standard deviations in parenthesis - rel diff?}
		\label{tab:resBenchmark}
\end{table} 


\textbf{intermediate results}


average plots

\section{Visualisation of class clustering}
insert the pca plots

\section{Discussion}
Data amount, circumvent: could self-engineer data. 

should have done visualisation first, if we have clear cluster separation, applying a neural network would be a bit exaggerated. And in that case, we could opt for a simple multi class support vector machine from the \verb|sklearn| library. However, using \verb|tensorflow| was the plan from the get-go as it is more industrially-applicable, so we disregarded simpler methods.

ensure that data is uniform. That is, some of the data has calibration and some hasnt. 

more sophisticated use of features.

Look more into defect types, its specifics

Sometimes the defect can only be detected from one side of the track -- AX11 and AX12 as one defect crossing sample with two signatures seen from different location. This would help in cases where the defect is only on one side of the track.

%Many a times the validation set is used as the test set, but it is not good practice. The test set is generally well curated. It contains carefully sampled data that spans the various classes that the model would face, when used in the real world.

You are on tracks which are "brand new- built in 2006-2018".  so the defects are all minor. The new measurement data we recently got would work much much better since they drove on pretty bad bad bad stuff :)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Conclusion and future work
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Conclusion and future work}

%%% CONCLUSION
\section{Conclusion}
Results were quite mediocre, but has a lot of room for improvement. I am sure that given more time I would be able to explore and evaluate the results further.

how good is the foundation to move onwards with further research

library code is built in an extensible form

overlap between switch and insulation joints


%%% FUTURE WORK
\section{Future work}
There is still a lot of work that needs to be done in this project. These are summarised in the next sub-sections -- in no particular order. 

\subsection{Channels}
It might be interesting to consider sensor fusion of the ZY axes and the axle channels (8 total channels). The transverse axis, Y, would especially be valuable for switches as this channel can pick up sideways hits in the case of switches. These switch signals are clearly different from that of the other entities and may thus be more easily separable.
	
In this project, only the accelerometer accelerations at the axle-boxes were considered. However, the other accelerometer sensors higher up in the vehicle: bogie(Z, Y) and body (Y) (see appendix \ref{figs:veh}), will also be worth analyzing.

\subsection{Peak windows}
we must not set the findpeakoffset too high

track entity dependent/specific window offsets

tune the peak finding parameters

the window offset can be very small (as small as possible without losing the peaks). Otherwise you will merge too many peaks using the peakfinder. 0.5 of even 0.1 should be ok. 

\subsection{Identification of infrastructure}
%To better identify infrastructure components and damages (entities), the order and distance between entities should be considered, as well as the uncertainty in the reported location of the entities themselves (databases are not always mm accurate) as well as the uncertainty in the reported location of the vehicle).
%Expected from layout: "...I....S,I,....Weld,....I,..............I,...S,..W,.."
%Measured hits: "...I..S,...I,...Weld,...I,......I...,...S,..W,.."
	
\subsection{Real-world simulated defects}
I have participated in ETH Hatchery \footnote{\url{https://sph.ethz.ch/eth-week-hatchery/}}, where our team built a prototype with a model train. We let the model train drive on the track with self-engineered defects. 


\newpage
\section{TODO}
\begin{itemize}
	\item F1 weighted (this already has info about true positive values) \verb|sklearn.metrics.f1_score|
	\item AUC
	\item tune models
	\item do acceleration channels
	\item PCA plots and get better results
	\item add speed as a feature
%	\item visualise what the network is doing using Harry's code
	\item concat all the axle channels and train on them
	\item try to use low pass filter - (would make everything faster)
	\item account for severity
	\item get rid of 'we'
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Bibliography
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliography{master}
%more would be good. and not only blogposts. 
%--> Machine Learning and Pattern Recognition book (the one that is probably also used inthe Deep learning class that you took).
%--> Railway-vehicle dynamics by Knothe,
%--> UIC defect catalog which SBB uses as a base for classifying the defects
%--> Some scientific articles on sound recognition/voice

%You can put more citations, for example about some articles focusing on recognizing speech/sound, signals which have also very similar signatures
\newpage
\cleardoublepage
\appendix
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Appendix introduction
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%0 Bankett
%1 Befestigung
%2 Dienstweg
%3 EKW / DKW
%4 Einfache und symmetrische Weiche
%5 Entwässerungsgraben
%6 Fahrbahn
%7 Gleis
%8 Gleisbettung
%9 Halbe Zungenvorrichtung
%10 Herzstück
%11 Herzstückspitze
%12 Kleber
%13 Rippenplatte
%14 Schiene
%15 Schienenklemme
%16 Schienenzwischenlage
%17 Schotter
%18 Schweissverbindung
%19 Schwelle
%20 Stockschiene
%21 Vignolschiene
%22 Weiche
%23 Zungenschiene
%24 insulationjoint
%25 switches
\chapter{Introduction}
\section{List of defect components}
\label{app:defcomp}
\begin{table}[H]
	\centering
	\begin{tabular}{|l|c|} \hline
		\textbf{Bankett} & 0 \\ \hline 
		\textbf{Befestigung} & 1\\ \hline
		\textbf{Dienstweg} & 2\\ \hline
		\textbf{EKW / DKW} & 3\\ \hline
		\textbf{Einfache und symmetrische Weiche} & 4\\ \hline
		\textbf{Entwässerungsgraben} & 5\\ \hline
		\textbf{Fahrbahn} & 6\\ \hline
		\textbf{Gleis} & 7\\ \hline
		\textbf{Gleisbettung} & 8\\ \hline
		\textbf{Halbe Zungenvorrichtung} & 9\\ \hline
		\textbf{Herzstück} & 10\\ \hline
		\textbf{Herzstückspitze} & 11\\ \hline
		\textbf{Kleber} & 12\\ \hline
		\textbf{Rippenplatte} & 13\\ \hline
		\textbf{Schiene} & 14\\ \hline
		\textbf{Schienenklemme} & 15\\ \hline
		\textbf{Schienenzwischenlage} & 16\\ \hline
		\textbf{Schotter} & 17\\ \hline
		\textbf{Schweissverbindung} & 18\\ \hline
		\textbf{Schwelle} & 19\\ \hline
		\textbf{Stockschiene} & 20\\ \hline
		\textbf{Vignolschiene} & 21\\ \hline
		\textbf{Weiche} & 22\\ \hline
		\textbf{Zungenschiene} & 23\\ \hline
	\end{tabular}
	\hspace*{0.5cm}	
	\begin{tabular}{|l|c|} \hline
		\textbf{Insulation Joint} & 24 \\ \hline
		\textbf{Switches} & 25 \\ \hline 
	\end{tabular}
	\caption{Defect components along with class labels}
\end{table}

\section{List of defect types}
\label{app:deftyp}
\begin{table}[H]
	\centering
	\begin{tabular}{|l|} \hline
		\textbf{AT-Schweissung mit Squat}\\ \hline
		\textbf{Ausbruch in der Zunge} \\ \hline
		\textbf{Bankett}\\ \hline
		\textbf{Beschädigte Betonschwellen} \\ \hline 
		\textbf{Entwässerung oder Wasserkanal verstopft}\\ \hline
		\textbf{Gleisgeometrie} \\ \hline
		\textbf{Grundparameter}\\ \hline
		\textbf{Gleisgeometrie, Spurweite} \\ \hline
		\textbf{Gleisgeometrie, Standardabweichungen}\\ \hline
		\textbf{Head-Checking:  Periodische Rissbildung} \\
		\textbf{/ Ausbrechungen an der Fahrkante} \\ \hline 
		\textbf{Isolierstoss mit Überwalzung}\\ \hline
		\textbf{Kilometer-, Hektometer- oder Metertafeln} \\ \hline
		\textbf{Lose/fehlende Schienenbefestigung}\\ \hline
		\textbf{Lose/fehlende Schwellenbefestigung}\\ \hline
		\textbf{Mitten in der Schienenlänge: Oberflächenfehler}\\ \hline
		\textbf{Mitten in der Schienenlänge: Schleuderstellen oder Schnellbremsspuren}\\ \hline
		\textbf{Mitten in der Schienenlänge: Squat} \\
		\textbf{/ Rissbildung und örtliche Einsenkung der Lauffläche}\\ \hline
		\textbf{Oberflächlicher Fehler (Flügelschiene oder Herz)}\\ \hline
		\textbf{Schienenende: Sprödbruch}\\ \hline
		\textbf{Schienenende: Verquetschung}\\ \hline
		\textbf{Schienenende: örtliche Einsenkung der Lauffläche}\\ \hline
		\textbf{Schotter auf Schwellen}\\ \hline
		\textbf{Schotterfliessen, weisser Schotter}\\ \hline
		\textbf{Ungenügendes Schotterprofil}\\ \hline
		\textbf{Verletzungen}\\ \hline
		\textbf{Weiterer Abweichungstyp}\\ \hline
		\textbf{Zungenspitze angefahren}\\ \hline
	\end{tabular}
	\caption{Defect types}
\end{table}
\section{Vehicle and accelerometer placements}
\label{figs:veh}
\begin{figure}[H]
	\centering
	\includegraphics[width = 0.58\textwidth]{imgs/veh0}
	\label{fig:veh0}
	
	\includegraphics[width = 0.58\textwidth]{imgs/veh1}
	\label{fig:veh1}
	
	\includegraphics[width = 0.58\textwidth]{imgs/veh2}
	\caption{Illustrations of the accelerometer placements on the DFZ. For this project we have only considered axle number 4 in the third figure. (Source of picture: SBB documents)}
	\label{fig:veh2}
\end{figure}

\section{SBB defect report example}
\label{app:report}
\begin{figure}[H]
	\centering
	\includegraphics[width = 0.9\textwidth]{imgs/defs/rep0}
	\caption{}
	\includegraphics[width = 0.9\textwidth]{imgs/defs/rep1}
	\caption{A typical report for an arbitrary defect usually contains one description page followed by its picture(s)}
	\label{fig:veh2}
\end{figure}

\section{Defects in Introduction}
\label{app:introdefects}
\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schwelle_2_AXLE_11_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schwelle_2_AXLE_12_819Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schwelle_2_AXLE_41_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schwelle_2_AXLE_42_819Z_DFZ01}
	\caption{Schwelle: \textit{Beschadigte Betonschwellen} (A-118152)}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Fahrbahn_0_AXLE_11_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Fahrbahn_0_AXLE_12_819Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Fahrbahn_0_AXLE_41_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Fahrbahn_0_AXLE_42_819Z_DFZ01}
	\caption{Fahrbahn: \textit{Verletzungen} (A-233599)}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Vignolschiene_12_AXLE_11_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Vignolschiene_12_AXLE_12_819Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Vignolschiene_12_AXLE_41_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Vignolschiene_12_AXLE_42_819Z_DFZ01}
	\caption{Vignolschiene: \textit{Verletzungen} (A-231400)}
\end{figure}

%range
\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Gleis_0_AXLE_11_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Gleis_0_AXLE_12_819Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Gleis_0_AXLE_41_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Gleis_0_AXLE_42_819Z_DFZ01}
	\caption{Gleis-149.8m: \textit{Head-Checking: Periodische Rissbildung / Ausbrechungen an der Fahrkante} (A-184063)}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schienenzwischenlage_2_AXLE_11_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schienenzwischenlage_2_AXLE_12_819Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schienenzwischenlage_2_AXLE_41_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schienenzwischenlage_2_AXLE_42_819Z_DFZ01}
	\caption{Schienenzwischenlage-5.0m: \textit{Weiterer Abweichungstyp} (A-146358)}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Bankett_1_AXLE_11_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Bankett_1_AXLE_12_819Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Bankett_1_AXLE_41_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Bankett_1_AXLE_42_819Z_DFZ01}
	\caption{Bankett-1169.5m: \textit{Ungenugendes Schotterprofil} (A-103213)}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Appendix Implementation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Implementation}
%%%%% Switches
%\begin{comment}
\subsection{Switches}
\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_13_AXLE_11_425Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_13_AXLE_12_425Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_13_AXLE_41_425Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_13_AXLE_42_425Z_DFZ01}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_16_AXLE_11_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_16_AXLE_12_077Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_16_AXLE_41_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_16_AXLE_42_077Z_DFZ01}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_17_AXLE_11_425Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_17_AXLE_12_425Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_17_AXLE_41_425Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_17_AXLE_42_425Z_DFZ01}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_18_AXLE_11_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_18_AXLE_12_077Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_18_AXLE_41_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/switches_18_AXLE_42_077Z_DFZ01}
\end{figure}

%%%%% Ins joints
\subsection{Insulation Joints}
\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_3_AXLE_11_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_3_AXLE_12_077Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_3_AXLE_41_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_3_AXLE_42_077Z_DFZ01}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_5_AXLE_11_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_5_AXLE_12_077Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_5_AXLE_41_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_5_AXLE_42_077Z_DFZ01}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_14_AXLE_11_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_14_AXLE_12_819Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_14_AXLE_41_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_14_AXLE_42_819Z_DFZ01}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_5_AXLE_11_330Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_5_AXLE_12_330Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_5_AXLE_41_330Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/insulationjoint_5_AXLE_42_330Z_DFZ01}
\end{figure}

%%%%% Defects
\subsection{Defects}
\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Bankett_0_AXLE_11_330Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Bankett_0_AXLE_12_330Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Bankett_0_AXLE_41_330Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Bankett_0_AXLE_42_330Z_DFZ01}
	\caption{Bankett}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Befestigung_0_AXLE_11_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Befestigung_0_AXLE_12_819Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Befestigung_0_AXLE_41_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Befestigung_0_AXLE_42_819Z_DFZ01}
	\caption{Befestigung}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Dienstweg_0_AXLE_11_330Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Dienstweg_0_AXLE_12_330Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Dienstweg_0_AXLE_41_330Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Dienstweg_0_AXLE_42_330Z_DFZ01}
	\caption{Dienstweg}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Entwässerungsgraben_0_AXLE_11_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Entwässerungsgraben_0_AXLE_12_077Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Entwässerungsgraben_0_AXLE_41_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Entwässerungsgraben_0_AXLE_42_077Z_DFZ01}
	\caption{Entwässerungsgraben}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/EKW_DKW_1_AXLE_11_425Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/EKW_DKW_1_AXLE_12_425Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/EKW_DKW_1_AXLE_41_425Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/EKW_DKW_1_AXLE_42_425Z_DFZ01}
	\caption{EKW / DKW}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Fahrbahn_0_AXLE_11_330Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Fahrbahn_0_AXLE_12_330Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Fahrbahn_0_AXLE_41_330Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Fahrbahn_0_AXLE_42_330Z_DFZ01}
	\caption{Fahrbahn}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Gleis_3_AXLE_11_330Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Gleis_3_AXLE_12_330Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Gleis_3_AXLE_41_330Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Gleis_3_AXLE_42_330Z_DFZ01}
	\caption{Gleis}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Gleisbettung_0_AXLE_11_330Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Gleisbettung_0_AXLE_12_330Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Gleisbettung_0_AXLE_41_330Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Gleisbettung_0_AXLE_42_330Z_DFZ01}
	\caption{Gleisbettung}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Herzstück_1_AXLE_11_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Herzstück_1_AXLE_12_077Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Herzstück_1_AXLE_41_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Herzstück_1_AXLE_42_077Z_DFZ01}
	\caption{Herzstück}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schiene_16_AXLE_11_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schiene_16_AXLE_12_077Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schiene_16_AXLE_41_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schiene_16_AXLE_42_077Z_DFZ01}
	\caption{Schiene}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schienenzwischenlage_1_AXLE_11_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schienenzwischenlage_1_AXLE_12_819Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schienenzwischenlage_1_AXLE_41_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schienenzwischenlage_1_AXLE_42_819Z_DFZ01}
	\caption{Schienenzwischenlage}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schotter_2_AXLE_11_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schotter_2_AXLE_12_077Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schotter_2_AXLE_41_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schotter_2_AXLE_42_077Z_DFZ01}
	\caption{Schotter}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schweissverbindung_0_AXLE_11_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schweissverbindung_0_AXLE_12_819Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schweissverbindung_0_AXLE_41_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schweissverbindung_0_AXLE_42_819Z_DFZ01}
	\caption{Schweissverbindung}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schwelle_0_AXLE_11_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schwelle_0_AXLE_12_077Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schwelle_0_AXLE_41_077Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Schwelle_0_AXLE_42_077Z_DFZ01}
	\caption{Schwelle}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Stockschiene_1_AXLE_11_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Stockschiene_1_AXLE_12_819Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Stockschiene_1_AXLE_41_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Stockschiene_1_AXLE_42_819Z_DFZ01}
	\caption{Stockschiene}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Vignolschiene_13_AXLE_11_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Vignolschiene_13_AXLE_12_819Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Vignolschiene_13_AXLE_41_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Vignolschiene_13_AXLE_42_819Z_DFZ01}
	\caption{Vignolschiene}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Weiche_0_AXLE_11_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Weiche_0_AXLE_12_819Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Weiche_0_AXLE_41_819Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Weiche_0_AXLE_42_819Z_DFZ01}
	\caption{Vignolschiene}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Zungenschiene_0_AXLE_11_425Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Zungenschiene_0_AXLE_12_425Z_DFZ01}
	
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Zungenschiene_0_AXLE_41_425Z_DFZ01}
	\includegraphics[width = 0.49\textwidth]{../AiyuDocs/new_signalplots/Zungenschiene_0_AXLE_42_425Z_DFZ01}
	\caption{Zungenschiene}
\end{figure}
%\end{comment}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Appendix Evaluation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Evaluation}
\begin{table}[H]
	\centering
\begin{tabular}{|l|ccccccccc|}
	\hline
	\backslashbox{run \#}{Metrics}
&{L}&{ACC}&{TP}&{TN}&{FP}&{FN}&{P}&{R}&{AUC} \\\hline\hline
	1 & $-$ & $-$ & $-$ & $-$ & $-$ & $-$ & $-$ & $-$ & $-$ \\ \hline
\end{tabular}
	\caption{Experiment result of 10 runs}
\end{table}

confusion matrix, epoch plots





\end{document}
